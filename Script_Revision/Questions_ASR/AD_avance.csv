Question;Reponse
Qu'est ce qu'une arborescence de domaine ? ; Ensemble de domaines et sous domaines utilisant un espace de nom contigu
C'est quoi le schema dans Active Directory ? ; C'est une partition de l'AD, unique a la foret, qui regroupe les attributs et les classes pour les objets AD
Quel est le fichier qui contient la base de donnee de l'AD ? ; C est le fichier ntds.dit dans c:/windows/NTDS sur tous les DC.
Comment on modifie le schema de l'AD ? ; En activant la console mmc Schema AD via la commande : regsvr32 schmmgmt.dll 
Comment se compose le SID d un objet ? Et a quels objets attribuent on ce SID ? ; Le SID se compose du SID de domaine + un RID, seules les entités de sécurité peuvent disposer d un SID
C'est quoi un DN ? (distinguished name) ; C'est le nom unique de l objet au sein de l AD, exemple : CN=Toto,CN=admin,DC=NABOO,DC=STAR,DC=WARS
Quels sont les 2 elements repliques en permanence dans un domaine AD entre les DC ? ; La base AD (NTDS) et le SYSVOL
Quelles sont les partitions obligatoire dans l AD ? ; Domaine, Schema, Configuration
Quel est le role de la partition de configuration ? A quel niveau se replique t elle ? ; Elle contient les infos de configuration des services du domaine (config des sites AD, config des services, partitionnement, ...) Elle se replique a l echelle de la foret.
Expliquez ce qu est le Catalogue global et a quoi il sert ? ; Le catalogue global contient l'intégralité des objets de la foret mais un nombre limité d'attributs (seuls attributs avec isMemberOfPartialAttributeSet), il permet de facilite la recherche d objets et d informations, par exemple dans le cas d un site distant. 
Quels sont les 5 roles FSMO ? ; Contrôleur de schéma - Maître d’opérations des noms de domaine - Maître d’infrastructure - Maître des ID relatifs (RID) - Émulateur PDC
Expliquez le role Emulateur PDC, a quoi il sert ? ; Emulateur PDC : controle les tentatives de login echouees et les verrouillages de compte, sert de reference pour la synchro horaire (NTP), gere les modif de passwd, gere (initialement) les modif GPO, ...
Expliquez le role de maitre d infrastructure ? ; il accélère les processus de réplication et la communication entre les contrôleurs de domaine et declenche / maintient la replication des objets entre les domaines. Il n est pas utilise dans le cadre d un domaine unique.
Comment appliquer correctement une GPO ? ; Il faut lier une GPO sur une OU contenant les utilisateurs / ordinateurs.
C est quoi le GUID ? ; Le GUID est l identifiant UNIQUE de tout objet, cet attribut est non modifiable durant toute la durée de vie de l'objet
A quoi sert la console Modification ADSI ? ; Elle permet d editer les valeurs des attributs des objets de l AD , c est un editeur LDAP, !! ELLE NE PERMET PAS DE MODIFIER LE SCHEMA !!
Quelle commande permet de controler l etat des DC du domaine ? ; la commande : dcdiag 
Quelle commande permet de verifier l etat des replications ? (et qu on utilise en general quand c est la merde...) ; C est la commande repadmin 
Quelle est le nom de la manipulation permettant de reparer / forcer la replication entre les DC dans un domaine AD ? ; (Pour FRS) C est le Burflags, c est une manipulation qui consiste a forcer la replication depuis un DC vers les autres en modifiant la cle de registre Burflags, attention c est une manipulation sensible. // Pour DFS la manipulation est differente et utilise la commande POLLAD ainsi que l attribut msDFSR-Enabled.
L AD se base sur plusieurs services principaux et primordiaux a son bon fonctionnement, lesquels ? ; DNS, Kerberos, DFSR (anciennement FSR), Netlogon, W32time
Quel est le type et quels sont les noms des enregistrements DNS pour l annuaire, l authentification, le catalogue global et la modification des passwd ? ; les enregistrements dns sont de type SRV (service), ce sont les suivants : _ldap - _kerberos - _gc - _kpasswd
Jusqu a combien de minutes de decalage peut tolerer Kerberos ? ; Jusqu a 5 minutes maximum.
J ai supprime un enregistrement SRV sans le vouloir, comment faire pour le recuperer ? ; Redemarrer le service Netlogon
A quoi correspond le niveau fonctionnel d un domaine ou de la foret ? ; Le niveau fonctionnel determine les fonctionnalites fournies au sein de la foret ou du domaine
Quelles commandes me permettent de remonter les informations du domaine ou de la foret ? ; les commandes : get-adforest ou get-addomain
Quelle est la methode preconisee par Microsoft pour la gestion des permissions NTFS sur les ressources ? ; AGDLP - Account > groupe Global > groupe Domain local > Permissions
Je creee un domaine enfant BABIDI sous le domaine BOO.DBZ, j effectue la creation / promo avec mon DC : NAMEK, quels roles FSMO possedera NAMEK ? ; Il possedera 3 roles car c est un sous domaine : Emulateur PDC, Maitre d infra et Maitre RID.
L un de mes DC possedant un role FSMO a explose, que puis je faire pour recuperer le role en question ? ; Il est possible d effectuer une saisie du role FSMO via les consoles ou la commande ntdsutil
Un serveur completement plante et en carafe possedait un role FSMO, je l ai alors saisi sur un autre DC, que dois je faire maintenant ? ; il faut faire tres attention a ce que l ancien serveur ne recontacte pas le reseau du domaine, celon Microsoft : vous devez soit formater et réinstaller l OS, soit forcer la rétrogradation sur un réseau privé puis supprimer les métadonnées sur un contrôleur de domaine survivant dans la forêt par le biais de la commande ntdsutil /metadata cleanup
Quel role FSMO est le plus important et poserait le plus d incident en cas de coupure de ce dernier ? ; l emulateur PDC
Quelle commande me permet de connaitre les DC possedant les roles FSMO ? ; netdom query fsmo ou get-adforest + get-addomain
Comment dois je proceder si je souhaite que les mots de passe de certains utilisateurs soient stockes sur le RODC de mon site distant ? ; Il faut ajouter les utilisateurs / un groupe au groupe de securite : Groupe de replication dont le mot de passe RODC est autorise ou ajouter un groupe d utilisateur dans l onglet replication de mot de passe dans les proprietes du RODC
J'ai installe un nouveau DC en 2019 dans mon domaine qui etait en 2012, je vais maintenant migrer le DC en 2012 vers 219, mon responsable m a demande de preparer le domaine, comment faire ? ; Il faut mettre a jour le schema en utilisant la commande ADPREP 
Que permet l USN ? (Update Sequence Number) ; L USN permet la granularite de replication de l AD : pour la mise a jour d un objet, l AD peut repliquer uniquement la valeur de l attribut qui a ete modifie plutot que de repliquer l objet entier, et ce grace a l USN qui est incremente a chaque modification
Quel est le numero de port et le protocole de transport pour LDAP ? ; LDAP - 389 - TCP/UDP
Quel est le numero de port et le protocole de transport pour Kerberos ? ; Kerberos - 88 TCP/UDP
Quel est le numero de port et le protocole de transport pour NetBios ? ; Attention Netbios utilise 3 ports pour 3 services differents : Netbios Name Service 137 TCP/UDP // Netbios datagram service 138 UDP // Netbios session service 139 TCP
Quel protocole utilise le port 135 TCP/UDP ? ; C est RPC endpoint mapper (remote procedure call)
Pourquoi la GPO default domain policies qui possede les strategie de mot de passe sont en strategie ordinateur ? ; Car la strategie de mot de passe est geree par le DC, c est donc sur lui qu il faut appliquer la strategie, et c est pourquoi c est une strategie ordinateur. 
Nous avons achete une nouvelle filliale, grace a quel outil puis je migrer leur Active Directory deja existant dans le notre ? ; Grace a l outil ADMT (AD Migration Tool)
Je souhaite mettre en place un serveur RDS Gateway en DMZ, cependant il doit etre integre au domaine et doit pouvoir communiquer avec mon DC dans le LAN, comment puis je faire pour eviter d avoir a ouvrir toute une plage de port immense dans le Firewall pour RPC ? ; Il est possible de fixer les ports utilises par RPC dans le registre
Je viens de finir de creer mon premier domaine, j ai installe 2 DCs, mais je ne sais pas sur lequel mettre le role Maitre d Infrastructure, que dois je faire ? ; Le Role maitre d infrastructure n est pas utilise dans le cadre d un domaine unique donc peu importe, a savoir que dans le cadre de multiple domaine il ne faut pas que le serveur possedant ce role soit Catalogue global !
Quels sont les roles FSMO ayant comme limite le domaine ? ; Emulateur PDC , Maitre d infrastructure , Maitre RID
Je suis replique a l echelle de la foret, je contiens les informations de classe et attributs de tous les objets de l AD, qui suis je ? ; Je suis la partition de schema !
Quelle est la premiere action d un poste lorsqu un utilisateur se connecte pour la premiere fois dans le domaine ? ; Le poste effectue une requete DNS de type SRV pour recuperer les informations concernant l enregistrement _Kerberos
Je souhaiterai mettre en place la possibilite de se connecter dans mon domaine Pillule.Rouge avec des logins de type : Neo@Matrix.elu , comment puis je faire ? ; Il faut mettre en place le routage des suffixes de noms (UPN) > console Domaine et Approbation > proprietes > ajouter le suffixe UPN matrix.elu , PUIS editer les proprietes de l utilisateur pour qu il puisse utiliser ce suffixe UPN.
La replication AD s effectue tous les combiens par defaut en INTRASITE et en INTERSITE ? ; INTRASITE = 15 secondes - INTERSITE = 180 min 
Pour que la replication se deroule correctement, quels services doivent être operationnels ? ; Kerberos, DNS et le reseau doivent tous etre operationnel.
Sur quel systeme de replication se base SYSVOL ? Et la base AD ? ; SYSVOL se replique via DSFR (anciennement FRS) et la Base AD par DRA (Directory Replication Agent)
Quel agent se charge de generer la topologie de replication en Intersite ? Et en Intrasite ? ; En intrasite = KCC (Knowledge Consistency Checker) , En Inter site = ISTG (Intersite Topology Generator)
Donnez moi les commandes qui permettent de : verifier l etat de la replication, forcer la replication, synchroniser les partenaires de replication, forcer la verification de la topologie ? ;  Afficher les partenaires REPADMIN /showrepl DC01 // Forcer la replication REPADMIN /replicate DC_cible DC_source partition  //  Synchroniser les partenaires REPADMIN /syncall   //  Forcer la verification de topologie REPADMIN /kcc 
Quelle commande permet de realiser des tests de replication et d afficher un rapport complet ? ; La commande DCDIAG
Par defaut comment est configurer la replication de la base AD ? Qui la gere ? ; La config par defaut ne met en place qu un seul site (Default first site name), KCC va alors generer la topologie tout seul et creer les connexions entre les differents DC, la replication sera effectuee toutes les 15 secondes 
Dans le cas d'une configuration avec plusieurs sites, comment un client reconnait il qu il doit s authentifier aupres d un DC et pas d un autre ? ; Il va faire une requete au DNS pour recuperer les enregistrements SRV liés a son site (et donc son subnet), il y a une partie specifique a chaque site dans la zone dns ( _SITE)
A quoi sert la case <Relier tous les liens de sites> dans les propriétés du conteneur IP dans la console Sites et services AD ? Est elle cochee ou decochee par defaut ? ; Par défaut cette case est cochee, KCC va avoir un comportement transitif et va relier tous les liens de sites , or si entre mon site 2 et mon site 3 il n'y a pas de connexion cela peut poser probleme.
Comment puis je creer un Pont de liaison entre 2 liens inter site ? Dans quel cas de figure dois je en creer ? ; Il faut creer manuellement un pont de liaison entre les liens inter site si nous avons decoché la case <Relier tous les liens de sites> , Pour le créer : Sites et services AD > Site > Inter-Site Transports > IP > clic droit > Nouveau pont entre lien de sites
A quoi correspond le coût dans le cadre d un lien de replication intersite ? ; Elle correspond a la vitesse de la ligne entre ces sites, plus la valeur est faible, plus la ligne est rapide
Le traffic lié à la replication de la base AD est il compressé par défaut ? ; En intrasite non, en intersite oui
Si je n utilise pas de catalogue global sur un site distant mais que je souhaite que le DC possède les informations 
J ai créé un utilisateur et une GPO sur un DC, je retrouve bien l utilisateur sur le 2eme DC mais pas la GPO, qu est ce qui pose probleme ? ; La replication de la base AD semble fonctionner correctement, mais la replication SYSVOL elle pose probleme (attention, la version de la GPO est stockée dans la base AD et le contenu de la GPO dans le SYSVOL) 
Donnez moi les differentes etapes dans le processus de replication INTRASITE ; 1- maj d un objet de l AD // 2-- 15 secondes apres l integration dans la base AD > notification du premier partenaire // 3- L agent DRA du premier partenaire initie la replication // 4- 3 secondes après avoir notifié son portenaire le DC source notifie son second partenaire de la maj // 5- L agent DRA du 2e partenaire initie a son tour la replication // etc ...
Quelles sont les cmdlet Powershell pour la gestion des replications de la base AD ? ; Get/New/Remove/Set-ADReplication ...
Quel type de modification dans l AD entraine une replication urgente sans delai ? ; les maj concernant la securite (Dé/Verouillage de compte, Password, FSMO,...) 
Quel est le role de KCC dans la mise en place d une replication INTER SITE ? ; Pour chaque site AD, le KCC d un des DC du site est désigné ISTG, il participe a la construction de la topologie de replication et designe le ou les serveurs de tete de pont par partition , et enfin il crée les objets de connexion.
Quelles sont les 3 contraintes respectées par KCC dans l'établissement d'une topologie de réplication ? ;  1- Toutes les maj devront être répliquées en 3 sauts MAX , 2- Les connexions créées sont UNIDIRECTIONNELS , 3- Les connexions sont toujours créées par paire (pour couvrir les 2 sens)
